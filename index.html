<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Chore Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide icons as SVG components
        const DollarSign = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>;
        const Plus = () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
        const Calendar = () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>;
        const TrendingUp = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>;
        const Camera = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>;
        const Download = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>;
        const Upload = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>;
        const LogOut = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>;
        const User = () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>;

        function FamilyChoreTracker() {
            const [currentUser, setCurrentUser] = useState(null);
            const [children] = useState(['Zoe', 'Emily']);
            const [chores, setChores] = useState([
                { id: 1, name: 'Wash dishes', amount: 5, assignedTo: null, dueDate: null, completed: false, completedDate: null, photo: null, recurring: null },
                { id: 2, name: 'Vacuum living room', amount: 8, assignedTo: null, dueDate: null, completed: false, completedDate: null, photo: null, recurring: null },
                { id: 3, name: 'Take out trash', amount: 3, assignedTo: null, dueDate: null, completed: false, completedDate: null, photo: null, recurring: 'weekly' },
                { id: 4, name: 'Clean bathroom', amount: 10, assignedTo: null, dueDate: null, completed: false, completedDate: null, photo: null, recurring: null },
                { id: 5, name: 'Mow lawn', amount: 15, assignedTo: null, dueDate: null, completed: false, completedDate: null, photo: null, recurring: null },
                { id: 6, name: 'Fold laundry', amount: 6, assignedTo: null, dueDate: null, completed: false, completedDate: null, photo: null, recurring: null },
            ]);
            const [newChoreName, setNewChoreName] = useState('');
            const [newChoreAmount, setNewChoreAmount] = useState('');
            const [newChoreRecurring, setNewChoreRecurring] = useState('');
            const [view, setView] = useState('chores');
            const [showPhotoModal, setShowPhotoModal] = useState(false);
            const [selectedChore, setSelectedChore] = useState(null);

            useEffect(() => {
                const savedData = localStorage.getItem('choreTrackerData');
                if (savedData) {
                    try {
                        const parsed = JSON.parse(savedData);
                        if (parsed.chores) setChores(parsed.chores);
                    } catch (e) {
                        console.error('Error loading saved data');
                    }
                }
            }, []);

            useEffect(() => {
                if (currentUser) {
                    const dataToSave = { chores };
                    localStorage.setItem('choreTrackerData', JSON.stringify(dataToSave));
                }
            }, [chores, currentUser]);

            const login = (user) => {
                setCurrentUser(user);
            };

            const logout = () => {
                setCurrentUser(null);
                setView('chores');
            };

            const addChore = () => {
                if (newChoreName && newChoreAmount) {
                    const newChore = {
                        id: Date.now(),
                        name: newChoreName,
                        amount: parseFloat(newChoreAmount),
                        assignedTo: null,
                        dueDate: null,
                        completed: false,
                        completedDate: null,
                        photo: null,
                        recurring: newChoreRecurring || null
                    };
                    setChores([...chores, newChore]);
                    setNewChoreName('');
                    setNewChoreAmount('');
                    setNewChoreRecurring('');
                }
            };

            const assignChore = (choreId, child, dueDate) => {
                setChores(chores.map(c => 
                    c.id === choreId ? { ...c, assignedTo: child, dueDate: dueDate } : c
                ));
            };

            const claimChore = (choreId, child) => {
                setChores(chores.map(c => 
                    c.id === choreId ? { ...c, assignedTo: child } : c
                ));
            };

            const completeChore = (choreId, photoData = null) => {
                const chore = chores.find(c => c.id === choreId);
                const completedDate = new Date().toISOString();
                
                setChores(chores.map(c => {
                    if (c.id === choreId) {
                        return { ...c, completed: true, completedDate, photo: photoData };
                    }
                    return c;
                }));

                if (chore.recurring) {
                    setTimeout(() => {
                        const newChore = {
                            ...chore,
                            id: Date.now(),
                            completed: false,
                            completedDate: null,
                            photo: null,
                            assignedTo: null,
                            dueDate: getNextDueDate(chore.recurring)
                        };
                        setChores(prev => [...prev, newChore]);
                    }, 500);
                }
            };

            const getNextDueDate = (recurring) => {
                const today = new Date();
                if (recurring === 'daily') {
                    today.setDate(today.getDate() + 1);
                } else if (recurring === 'weekly') {
                    today.setDate(today.getDate() + 7);
                } else if (recurring === 'monthly') {
                    today.setMonth(today.getMonth() + 1);
                }
                return today.toISOString().split('T')[0];
            };

            const uncompleteChore = (choreId) => {
                setChores(chores.map(c => 
                    c.id === choreId ? { ...c, completed: false, completedDate: null, photo: null } : c
                ));
            };

            const handlePhotoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        completeChore(selectedChore, reader.result);
                        setShowPhotoModal(false);
                        setSelectedChore(null);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const openPhotoModal = (choreId) => {
                setSelectedChore(choreId);
                setShowPhotoModal(true);
            };

            const getWeeklyEarnings = (child) => {
                const oneWeekAgo = new Date();
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                
                return chores
                    .filter(c => c.assignedTo === child && c.completed && new Date(c.completedDate) > oneWeekAgo)
                    .reduce((sum, c) => sum + c.amount, 0);
            };

            const getTotalEarnings = (child) => {
                return chores
                    .filter(c => c.assignedTo === child && c.completed)
                    .reduce((sum, c) => sum + c.amount, 0);
            };

            const isOverdue = (dueDate) => {
                if (!dueDate) return false;
                return new Date(dueDate) < new Date() && new Date(dueDate).toDateString() !== new Date().toDateString();
            };

            const exportData = () => {
                const dataStr = JSON.stringify({ chores }, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'chore-tracker-data.json';
                link.click();
            };

            const importData = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const data = JSON.parse(event.target.result);
                            if (data.chores) setChores(data.chores);
                            alert('Data imported successfully!');
                        } catch (error) {
                            alert('Error importing data. Please check the file format.');
                        }
                    };
                    reader.readAsText(file);
                }
            };

            if (!currentUser) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                        <div className="bg-white rounded-lg shadow-xl p-8 max-w-md w-full">
                            <div className="text-center mb-8">
                                <div className="w-16 h-16 text-green-600 mx-auto mb-4 flex items-center justify-center">
                                    <DollarSign />
                                </div>
                                <h1 className="text-3xl font-bold text-indigo-900 mb-2">Family Chore Tracker</h1>
                                <p className="text-gray-600">Select your profile to continue</p>
                            </div>
                            <div className="space-y-3">
                                <button
                                    onClick={() => login('Parent')}
                                    className="w-full px-6 py-4 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-semibold text-lg flex items-center justify-center gap-2"
                                >
                                    <User />
                                    Parent Login
                                </button>
                                {children.map(child => (
                                    <button
                                        key={child}
                                        onClick={() => login(child)}
                                        className="w-full px-6 py-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition font-semibold text-lg flex items-center justify-center gap-2"
                                    >
                                        <User />
                                        {child}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            const isParent = currentUser === 'Parent';
            const availableChores = isParent ? chores : chores.filter(c => !c.assignedTo || c.assignedTo === currentUser);

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                            <div className="flex justify-between items-start flex-wrap gap-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-indigo-900 mb-2 flex items-center gap-2">
                                        <span className="text-green-600"><DollarSign /></span>
                                        Family Chore Tracker
                                    </h1>
                                    <p className="text-gray-600">Logged in as: <span className="font-semibold text-indigo-600">{currentUser}</span></p>
                                </div>
                                <div className="flex gap-2 flex-wrap">
                                    {isParent && (
                                        <>
                                            <button
                                                onClick={exportData}
                                                className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold flex items-center gap-2"
                                            >
                                                <Download />
                                                Export
                                            </button>
                                            <label className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold flex items-center gap-2 cursor-pointer">
                                                <Upload />
                                                Import
                                                <input type="file" accept=".json" onChange={importData} className="hidden" />
                                            </label>
                                        </>
                                    )}
                                    <button
                                        onClick={logout}
                                        className="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition font-semibold flex items-center gap-2"
                                    >
                                        <LogOut />
                                        Logout
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="flex gap-2 mb-6">
                            <button
                                onClick={() => setView('chores')}
                                className={`px-6 py-2 rounded-lg font-semibold transition ${
                                    view === 'chores' 
                                        ? 'bg-indigo-600 text-white' 
                                        : 'bg-white text-gray-700 hover:bg-gray-50'
                                }`}
                            >
                                Chores
                            </button>
                            <button
                                onClick={() => setView('earnings')}
                                className={`px-6 py-2 rounded-lg font-semibold transition flex items-center gap-2 ${
                                    view === 'earnings' 
                                        ? 'bg-indigo-600 text-white' 
                                        : 'bg-white text-gray-700 hover:bg-gray-50'
                                }`}
                            >
                                <TrendingUp />
                                Earnings
                            </button>
                        </div>

                        {view === 'chores' && (
                            <>
                                {isParent && (
                                    <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                                        <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                            <Plus />
                                            Add New Chore
                                        </h2>
                                        <div className="flex gap-3 flex-wrap">
                                            <input
                                                type="text"
                                                placeholder="Chore name"
                                                value={newChoreName}
                                                onChange={(e) => setNewChoreName(e.target.value)}
                                                className="flex-1 min-w-[200px] px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                            />
                                            <input
                                                type="number"
                                                placeholder="Amount (£)"
                                                value={newChoreAmount}
                                                onChange={(e) => setNewChoreAmount(e.target.value)}
                                                className="w-32 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                            />
                                            <select
                                                value={newChoreRecurring}
                                                onChange={(e) => setNewChoreRecurring(e.target.value)}
                                                className="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                            >
                                                <option value="">One-time</option>
                                                <option value="daily">Daily</option>
                                                <option value="weekly">Weekly</option>
                                                <option value="monthly">Monthly</option>
                                            </select>
                                            <button
                                                onClick={addChore}
                                                className="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-semibold"
                                            >
                                                Add Chore
                                            </button>
                                        </div>
                                    </div>
                                )}

                                <div className="grid gap-4">
                                    {availableChores.filter(c => !c.completed).map(chore => (
                                        <div key={chore.id} className="bg-white rounded-lg shadow p-6">
                                            <div className="flex items-start justify-between gap-4 flex-wrap">
                                                <div className="flex-1 min-w-[200px]">
                                                    <div className="flex items-center gap-2 flex-wrap">
                                                        <h3 className="text-lg font-semibold text-gray-800">{chore.name}</h3>
                                                        {chore.recurring && (
                                                            <span className="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full font-semibold">
                                                                {chore.recurring}
                                                            </span>
                                                        )}
                                                    </div>
                                                    <p className="text-2xl font-bold text-green-600 mt-1">£{chore.amount.toFixed(2)}</p>
                                                    {chore.assignedTo && (
                                                        <p className="text-sm text-indigo-600 mt-2">
                                                            Assigned to: <span className="font-semibold">{chore.assignedTo}</span>
                                                        </p>
                                                    )}
                                                    {chore.dueDate && (
                                                        <p className={`text-sm mt-1 flex items-center gap-1 ${
                                                            isOverdue(chore.dueDate) ? 'text-red-600 font-semibold' : 'text-gray-600'
                                                        }`}>
                                                            <Calendar />
                                                            Due: {new Date(chore.dueDate).toLocaleDateString()}
                                                            {isOverdue(chore.dueDate) && ' (Overdue!)'}
                                                        </p>
                                                    )}
                                                </div>
                                                
                                                <div className="flex flex-col gap-2">
                                                    {!chore.assignedTo && !isParent ? (
                                                        <button
                                                            onClick={() => claimChore(chore.id, currentUser)}
                                                            className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold"
                                                        >
                                                            Claim This Chore
                                                        </button>
                                                    ) : !chore.assignedTo && isParent ? (
                                                        <div className="flex gap-2 items-center flex-wrap">
                                                            <select
                                                                onChange={(e) => {
                                                                    if (e.target.value) {
                                                                        const child = e.target.value;
                                                                        const dueDate = chore.recurring ? getNextDueDate(chore.recurring) : null;
                                                                        assignChore(chore.id, child, dueDate);
                                                                        e.target.value = '';
                                                                    }
                                                                }}
                                                                className="px-3 py-2 border border-gray-300 rounded text-sm"
                                                            >
                                                                <option value="">Assign to...</option>
                                                                {children.map(child => (
                                                                    <option key={child} value={child}>
                                                                        {child}
                                                                    </option>
                                                                ))}
                                                            </select>
                                                            <input
                                                                type="date"
                                                                onChange={(e) => {
                                                                    if (e.target.value) {
                                                                        assignChore(chore.id, children[0], e.target.value);
                                                                    }
                                                                }}
                                                                className="px-3 py-2 border border-gray-300 rounded text-sm"
                                                            />
                                                        </div>
                                                    ) : (chore.assignedTo === currentUser || isParent) ? (
                                                        <button
                                                            onClick={() => openPhotoModal(chore.id)}
                                                            className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold flex items-center gap-2"
                                                        >
                                                            <Camera />
                                                            Complete
                                                        </button>
                                                    ) : null}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>

                                {availableChores.filter(c => c.completed).length > 0 && (
                                    <div className="mt-8">
                                        <h2 className="text-xl font-bold text-gray-800 mb-4">Completed Chores</h2>
                                        <div className="grid gap-4">
                                            {availableChores.filter(c => c.completed).map(chore => (
                                                <div key={chore.id} className="bg-green-50 rounded-lg shadow p-6 border-l-4 border-green-500">
                                                    <div className="flex items-start justify-between flex-wrap gap-4">
                                                        <div className="flex-1">
                                                            <h3 className="text-lg font-semibold text-gray-800">{chore.name}</h3>
                                                            <p className="text-xl font-bold text-green-600">£{chore.amount.toFixed(2)}</p>
                                                            <p className="text-sm text-gray-600 mt-1">
                                                                Completed by {chore.assignedTo} on {new Date(chore.completedDate).toLocaleDateString()}
                                                            </p>
                                                            {chore.photo && (
                                                                <div className="mt-3">
                                                                    <img src={chore.photo} alt="Chore completion" className="max-w-xs rounded-lg shadow" />
                                                                </div>
                                                            )}
                                                        </div>
                                                        {isParent && (
                                                            <button
                                                                onClick={() => uncompleteChore(chore.id)}
                                                                className="px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition text-sm"
                                                            >
                                                                Undo
                                                            </button>
                                                        )}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </>
                        )}

                        {view === 'earnings' && (
                            <div className="grid gap-6 md:grid-cols-2">
                                {(isParent ? children : [currentUser]).map(child => (
                                    <div key={child} className="bg-white rounded-lg shadow-lg p-6">
                                        <h2 className="text-2xl font-bold text-indigo-900 mb-4">{child}</h2>
                                        <div className="space-y-4">
                                            <div className="bg-blue-50 p-4 rounded-lg">
                                                <p className="text-sm text-gray-600 mb-1">This Week</p>
                                                <p className="text-3xl font-bold text-blue-600">£{getWeeklyEarnings(child).toFixed(2)}</p>
                                            </div>
                                            <div className="bg-green-50 p-4 rounded-lg">
                                                <p className="text-sm text-gray-600 mb-1">Total Earned</p>
                                                <p className="text-3xl font-bold text-green-600">£{getTotalEarnings(child).toFixed(2)}</p>
                                            </div>
                                            <div>
                                                <p className="text-sm font-semibold text-gray-700 mb-2">Recent Completed Chores:</p>
                                                <ul className="space-y-1">
                                                    {chores.filter(c => c.assignedTo === child && c.completed).slice(-5).map(c => (
                                                        <li key={c.id} className="text-sm text-gray-600 flex justify-between">
                                                            <span>{c.name}</span>
                                                            <span className="font-semibold text-green-600">£{c.amount.toFixed(2)}</span>
                                                        </li>
                                                    ))}
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
